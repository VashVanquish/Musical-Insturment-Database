DROP TABLE IF EXISTS Wind_Materials;
DROP TABLE IF EXISTS Electric_Effects;
DROP TABLE IF EXISTS Electric_Electronics;
DROP TABLE IF EXISTS Electric_Inputs;
DROP TABLE IF EXISTS Electric_Outputs;
DROP TABLE IF EXISTS Strings;
DROP TABLE IF EXISTS Percussion;
DROP TABLE IF EXISTS Keyboards;
DROP TABLE IF EXISTS Wind;
DROP TABLE IF EXISTS Electric;
DROP TABLE IF EXISTS Instrument;
DROP TABLE IF EXISTS Item;
DROP TABLE IF EXISTS Warranty;
DROP TABLE IF EXISTS Product;
DROP TABLE IF EXISTS Customer;
DROP TABLE IF EXISTS Employee;
DROP TABLE IF EXISTS Person_Email;
DROP TABLE IF EXISTS Person_Phone;
DROP TABLE IF EXISTS Person;
DROP TABLE IF EXISTS Warehouse;
DROP TABLE IF EXISTS Store;
DROP TABLE IF EXISTS Vendor_Phone;
DROP TABLE IF EXISTS Vendor_Email;
DROP TABLE IF EXISTS Vendor;

-- NOTE: Remove block comment to integrate with rest of schema
CREATE TABLE IF NOT EXISTS Vendor(
    VID CHAR(8) NOT NULL,
    Name VARCHAR(50) NOT NULL,
    Address VARCHAR(200) NOT NULL,
	Username VARBINARY(100),
    Password VARBINARY(100),
    PRIMARY KEY (VID)    
)
engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE IF NOT EXISTS Product(
	UPC NUMERIC(12) NOT NULL,
    CONSTRAINT UPC_Check CHECK(UPC >= 0),
	ProductName VARCHAR(50) NOT NULL,
    ProductDescription VARCHAR(1000) NOT NULL,
    ProductType VARCHAR(30) NOT NULL,
    SpaceRequired NUMERIC(6) NOT NULL,
    CONSTRAINT SpaceRequired_Check CHECK(SpaceRequired > 0),
    Price NUMERIC(8,2) NOT NULL,
    CONSTRAINT Price_Check CHECK(Price > 0),
    VID CHAR(8) NOT NULL,
    PRIMARY KEY (UPC),
    FOREIGN KEY (VID) REFERENCES Vendor(VID) ON DELETE CASCADE ON UPDATE CASCADE)
    engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE IF NOT EXISTS Instrument(
	UPC NUMERIC(12) NOT NULL,
    Weight NUMERIC(5,2) NOT NULL,
    CONSTRAINT Min_Weight_Check CHECK(Weight > 0),
    PRIMARY KEY (UPC),
    FOREIGN KEY (UPC) REFERENCES Product(UPC) ON DELETE CASCADE ON UPDATE CASCADE);

CREATE TABLE IF NOT EXISTS Strings(
	UPC NUMERIC(12) NOT NULL,
    NumberOfStrings NUMERIC(2) NOT NULL,
    CONSTRAINT String_Check CHECK(NumberOfStrings > 0),
    Scale NUMERIC(4,2) NOT NULL,
    CONSTRAINT Scale CHECK(Scale > 0),
    Body VARCHAR(30) NOT NULL,
    Neck VARCHAR(30) NOT NULL,
    Frets NUMERIC(2) NOT NULL,
    PRIMARY KEY (UPC),
    FOREIGN KEY (UPC) REFERENCES Instrument(UPC) ON DELETE CASCADE ON UPDATE CASCADE);

CREATE TABLE IF NOT EXISTS Percussion(
	UPC NUMERIC(12) NOT NULL,
    Diameter NUMERIC(4,2) NOT NULL,
    CONSTRAINT Diameter_Check CHECK(Diameter > 0),
    Depth NUMERIC (4,2) NOT NULL,
    CONSTRAINT Depth_Check CHECK(Depth > 0),
    Construction VARCHAR(80) NOT NULL,
    PRIMARY KEY (UPC),
    FOREIGN KEY (UPC) REFERENCES Instrument(UPC) ON DELETE CASCADE ON UPDATE CASCADE);
    
CREATE TABLE IF NOT EXISTS Keyboards(
	UPC NUMERIC(12) NOT NULL,
    NumberOfKeys NUMERIC(3) NOT NULL,
    CONSTRAINT NumberOfKeys_Min_Check CHECK(NumberOfKeys > 0),
    CONSTRAINT NumberOfKeys_Max_Check CHECK(NumberOfKeys < 200),
    KeyType VARCHAR(20) NOT NULL,
    PRIMARY KEY (UPC),
    FOREIGN KEY (UPC) REFERENCES Instrument(UPC) ON DELETE CASCADE ON UPDATE CASCADE);
    
    
CREATE TABLE IF NOT EXISTS Wind(
	UPC NUMERIC(12) NOT NULL,
    Tuning CHAR(2) NOT NULL,
    CONSTRAINT Tuning_Check CHECK(Tuning IN ('A', 'Bb', 'B', 'C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab')),
    PRIMARY KEY (UPC),
    FOREIGN KEY (UPC) REFERENCES Instrument(UPC) ON DELETE CASCADE ON UPDATE CASCADE);
    
CREATE TABLE IF NOT EXISTS Wind_Materials(
	UPC NUMERIC(12) NOT NULL,
    Material VARCHAR(20) NOT NULL,
    PRIMARY KEY (UPC, Material),
    FOREIGN KEY (UPC) REFERENCES Wind(UPC) ON DELETE CASCADE ON UPDATE CASCADE);
    
CREATE TABLE IF NOT EXISTS Electric(
	UPC NUMERIC(12) NOT NULL,
    Polyphony VARCHAR(30) NOT NULL,
    PRIMARY KEY(UPC),
    FOREIGN KEY (UPC) REFERENCES Instrument(UPC) ON DELETE CASCADE ON UPDATE CASCADE);
    
CREATE TABLE IF NOT EXISTS Electric_Outputs(
	UPC NUMERIC(12) NOT NULL,
    Output VARCHAR(30) NOT NULL,
    PRIMARY KEY(UPC, Output),
    FOREIGN KEY(UPC) REFERENCES Electric(UPC) ON DELETE CASCADE ON UPDATE CASCADE);
    
CREATE TABLE IF NOT EXISTS Electric_Inputs(
	UPC NUMERIC(12) NOT NULL,
    Input VARCHAR(30) NOT NULL,
    PRIMARY KEY(UPC, Input),
    FOREIGN KEY(UPC) REFERENCES Electric(UPC) ON DELETE CASCADE ON UPDATE CASCADE);
    
CREATE TABLE IF NOT EXISTS Electric_Effects(
	UPC NUMERIC(12) NOT NULL,
    Effect VARCHAR(30) NOT NULL,
    PRIMARY KEY(UPC, Effect),
    FOREIGN KEY(UPC) REFERENCES Electric(UPC));

CREATE TABLE IF NOT EXISTS Electric_Electronics(
	UPC NUMERIC(12) NOT NULL,
    ElectricComponent VARCHAR(50) NOT NULL,
    PRIMARY KEY(UPC, ElectricComponent),
    FOREIGN KEY(UPC) REFERENCES Electric(UPC) ON DELETE CASCADE ON UPDATE CASCADE);

CREATE TABLE IF NOT EXISTS Warehouse(
	LID NUMERIC(4) NOT NULL,
    Address VARCHAR(200) NOT NULL,
    Phone NUMERIC(13) NOT NULL,
    SpaceAvailable INT NOT NULL,
    Capacity INT NOT NULL,
    PRIMARY KEY(LID),
    CONSTRAINT Warehouse_SpaceAvailable_Check CHECK(SpaceAvailable >= 0),
    CONSTRAINT Warehouse_Capacity_Check CHECK(Capacity >= 0));
    
CREATE TABLE IF NOT EXISTS Store(
	LID NUMERIC(4) NOT NULL,
    Address VARCHAR(200) NOT NULL,
    Phone NUMERIC(13) NOT NULL,
    SpaceAvailable INT NOT NULL,
    Capacity INT NOT NULL,
    Sales NUMERIC(14, 2) NOT NULL,
    PRIMARY KEY(LID),
    CONSTRAINT Store_SpaceAvailable_Check CHECK(SpaceAvailable >= 0),
    CONSTRAINT Store_Capacity_Check CHECK(Capacity >= 0),
    CONSTRAINT Sales_Check CHECK(Sales >= 0));

CREATE TABLE IF NOT EXISTS Person(
	PID CHAR(8) NOT NULL,
    Name VARBINARY(100),
    Address VARBINARY(100),
    Username VARBINARY(100),
    Password VARBINARY(100),
    PRIMARY KEY(PID))
    engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE IF NOT EXISTS Customer(
	PID CHAR(8) NOT NULL,
    Credit NUMERIC(8, 2) NOT NULL,
    PRIMARY KEY(PID),
    FOREIGN KEY(PID) REFERENCES PERSON(PID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT Credit_Check CHECK(Credit >= 0))
     engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
    
CREATE TABLE IF NOT EXISTS Employee(
	PID CHAR(8) NOT NULL,
    Salary NUMERIC(10, 2) NOT NULL,
    Position VARCHAR(30) NOT NULL,
    LID NUMERIC(4) NOT NULL,
    PRIMARY KEY(PID),
    FOREIGN KEY(PID) REFERENCES Person(PID) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY(LID) REFERENCES Store(LID) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY(LID) REFERENCES Warehouse(LID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT Salary_Check CHECK(Salary >= 0))
     engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
    
CREATE TABLE IF NOT EXISTS Warranty(
	UPC NUMERIC(12) NOT NULL,
    SerialNumber NUMERIC(12) NOT NULL,
    PID CHAR(8) NOT NULL,
    Coverage VARCHAR(20) NOT NULL,
    PRIMARY KEY(UPC, SerialNumber),
    FOREIGN KEY(UPC) REFERENCES Product(UPC) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY(PID) REFERENCES Customer(PID) ON DELETE CASCADE ON UPDATE CASCADE)
     engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
    
CREATE TABLE IF NOT EXISTS Item(
	SKU NUMERIC(12) NOT NULL,
    SerialNumber NUMERIC(12) NOT NULL,
    UPC NUMERIC(12) NOT NULL,
    LID NUMERIC(4) NOT NULL,
    OnHand_Order BIT NOT NULL,
    PRIMARY KEY(SKU),
    FOREIGN KEY(UPC) REFERENCES PRODUCT(UPC) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY(LID) REFERENCES STORE(LID) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY(LID) REFERENCES WAREHOUSE(LID) ON DELETE CASCADE ON UPDATE CASCADE);
    
CREATE TABLE IF NOT EXISTS Person_Email(

    PID CHAR(8) NOT NULL,
    Email VARBINARY(100) NOT NULL,
    PRIMARY KEY (PID),
    FOREIGN KEY (PID) REFERENCES Person(PID) ON DELETE CASCADE ON UPDATE CASCADE)
    engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE IF NOT EXISTS Person_Phone(

    PID CHAR(8) NOT NULL,
    Phone VARBINARY(100) NOT NULL,
    PRIMARY KEY (PID),
    FOREIGN KEY (PID) REFERENCES Person(PID) ON DELETE CASCADE ON UPDATE CASCADE)
    engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE IF NOT EXISTS Vendor_Email(

    VID CHAR(8) NOT NULL,
    Email VARCHAR(100) NOT NULL,
    PRIMARY KEY (VID, Email),
    FOREIGN KEY (VID) REFERENCES Vendor(VID) ON DELETE CASCADE ON UPDATE CASCADE)
     engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE IF NOT EXISTS Vendor_Phone(

    VID CHAR(8) NOT NULL,
    Phone CHAR(13) NOT NULL,
    PRIMARY KEY (VID),
    FOREIGN KEY (VID) REFERENCES Vendor(VID) ON DELETE CASCADE ON UPDATE CASCADE)
     engine=INNODB DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;